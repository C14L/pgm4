{% load i18n markdown_deux_tags bleach_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}pre.gunta.me{% endblock %}</title>
    <style>
/* ! normalize.min.css */progress,sub,sup{vertical-align:baseline}button,hr,input{ overflow:visible}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{ margin:0} figcaption, menu,article,aside,details,figure,footer,header,main,nav,section,summary{display:block}audio,canvas,progress,video{ display:inline-block}audio:not([controls]){ display:none;height:0} [hidden],template{ display:none}a{ background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{ border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{ background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}img{ border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}button,input,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{}button,select{text-transform:none}[type=submit], [type=reset],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{ -webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{ -webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{ -webkit-appearance:button;font:inherit}

      html { box-sizing: border-box; font: normal 16px/16px "Georgia", serif; }
      *, *:before, *:after { box-sizing: inherit; font: inherit; }
      body { margin: 0; padding: 0; padding-top: 48px; }

      a, a:hover { text-decoration: none; }
      h1 { font-size: 28px; line-height: 32px; margin: 16px 0; padding: 0; }
      h2 { font-size: 24px; line-height: 28px; margin: 16px 0; padding: 0; }
      p { font-size: 16px; line-height: 24px; margin: 0; padding: 0; }

      header { position: fixed; top: 0; right: 0; bottom: auto; left: 0; height: 48px; background-color: rgba(255, 255, 255, 0.82); color: #333; margin: 0; padding: 0; font-size: 0; box-shadow: 0 0 16px rgba(0, 0, 0, 0.32); z-index: 1000; }
      header a, header span { display: inline-block; color: inherit; vertical-align: middle; }
      header a.site-name { font: normal 24px/48px sans-serif; margin: 0; padding: 0 16px; }
      header .header-nav { font-size: 0; vertical-align: middle; float: right; }
      header .header-nav a { font: normal 16px/48px sans-serif; border-left: 1px solid rgba(255, 255, 255, 0.15); border-right: 1px solid rgba(0, 0, 0, 0.3); margin: 0; padding: 0 16px; }
      header .header-nav a:first-of-type { border-left: none; font-weight: bold; }
      header .header-nav a:last-of-type { border-right: none; }

      header .header-nav a.active { position: relative; }
      header .header-nav a.active:after { content: '▲'; position: absolute; top: auto; right: 0; bottom: -16px; left: 0; text-align: center; color: rgba(0, 0, 0, 0.32); }

      main { margin: 0 auto; padding: 8px; max-width: 800px; }

      form ul.errorlist { list-style: none; margin: 0; padding: 0; }
      form ul.errorlist li { display: inline-block; background: #C00; color: #FFF; margin: 4px; padding: 4px 8px; }

      /* Ask a question, answer a question, add a comment. */
      form.content-form { display: block; }
      form.content-form .helptext { display: none; }

      /* Ask a question */
      form.content-form.question-form {  }
      form.content-form.question-form p { margin: 16px 0; }
      form.content-form.question-form [name] { display: block; margin: 0; padding: 8px; font-size: 1.5rem; background-color: #FFF; }
      form.content-form.question-form [name="title"] { width: 100%; height: 2.5em; }
      form.content-form.question-form [name="text"] { width: 100%; height: 8em; }

      form.content-form.question-form ul#id_tags { list-style: none; margin: 0; padding: 0; }
      form.content-form.question-form ul#id_tags li { display: inline-block; margin: 0; padding: 0; }

      form.content-form.question-form ul#id_tags li label { display: inline-block; font-size: 17px; margin: 2px; padding: 10px; background-color: #BBB; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); color: white; position: relative; padding-left: 28px; border-top-left-radius: 16px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 16px; cursor: pointer; box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.25); }
      form.content-form.question-form ul#id_tags li label input { display: inline; font-size: 18px; width: 0px; }
      form.content-form.question-form ul#id_tags li label input:before { content: '❋'; position: absolute; left: 8px; color: rgba(0, 0, 0, 0.5); }
      form.content-form.question-form ul#id_tags li label input:checked:before { color: rgba(0, 255, 255, 0.75); }

      form .content-text { width: 100%; }
      form.answer-form .content-text { height: 10em; }

      /**
       * List of tabs next to questions.
      **/

      .tags.list { display: block; font-size: 0; margin: 0; padding: 0; }
      .tag.item { display: inline-block; font-size: 15px; line-height: 1.675em; margin: 4px 1.15em; padding: 0; background-color: transparent; color: #888; position: relative; cursor: pointer; overflow: visible; border: 1px solid rgba(0,0,0,0.32); border-width: 1px 0; transition: 0.3s ease-out; }
      .tag.item:before { content: ''; position: absolute; left: -0.65em; top: 0.205em; width: 1.265em; height: 1.265em; background-color: transparent; transform: rotate(45deg); border: 1px solid #888; border-width: 0 0 1px 1px; transition: 0.3s ease-out; }
      .tag.item:after { content: ''; position: absolute; right: -0.65em; top: 0.205em; width: 1.265em; height: 1.265em; background-color: transparent; transform: rotate(45deg); border: 1px solid #888; border-width: 1px 1px 0 0; transition: 0.3s ease-out; }
      .tag.item:hover { color: #333; transition: 0.3s ease-out; }
      .tag.item:hover:before { border-color: #333; transition: 0.3s ease-out; }
      .tag.item:hover:after { border-color: #333; transition: 0.3s ease-out; }
      .tag.item.large { font-size: 20px; }
      .tag.item.medium { font-size: 16px; }
      .tag.item.small { font-size: 13.3px; }
      .tag.item.tiny { font-size: 12px; }

      form.content-form.answer-form {  }

      form.content-form.comment-form {  }

      /*  */
      .messages { list-style: none; margin: 0; padding: 0; position: fixed; top: auto; right: 0; bottom: 16px; left: 0; }
      .messages .message { max-width: 600px; margin: 0 auto; padding: 8px; background-color: rgba(0, 0, 0, 0.82); color: white; }
      .messages .message.hide { transition: 0.3s ease-out; opacity: 0; }

      /* Any Content item. */
      .item { overflow: hidden; margin: 0; padding: 8px 0; }
      .item .updown { float: left; background-color: transparent; margin: 0; padding: 0; }
      .item .updown .points { text-align: center; padding: 2px 0; color: #888; }
      .item .updown form {  }
      .item .updown form.up {  }
      .item .updown form.down {  }
      .item .updown form input { font-size: 28px; line-height: 28px; border: none; outline: none; background: none; color: #CCC; cursor: pointer; transition: 0.3s ease-out; }
      .item .updown form input:hover { color: #AAA; transition: 0.3s ease-out; }
      .item .updown form.active input { color: #333; }

      .item h1 { margin: 0; }
      .item h2 { margin: 0 0 8px 0; color: #333; }
      .item h2 a { color: inherit; }
      .item .content { margin: 0 0 0 50px; padding: 0; }

      .question.detail {  }

      .question.item.header {  }
      .question.item.header .meta { margin: 8px 0; padding: 0; }

      .question.content { margin: 16px 0 16px 42px;  }
      .question.content p { font-size: 1.15rem; line-height: 1.5em; margin: 0.5em 0; }
      .question.content p:first-child { margin-top: 0; }
      .question.content p:last-child { margin-bottom: 0; }

      .question.detail .links { display: inline-block; margin: 16px 0 16px 50px; padding: 0; }

      .answers.list { overflow: hidden; margin: 0; padding: 0; }
      .answer.item { margin: 0; padding: 0; }
      .answer.item .content { margin: 0; padding: 0; }
      .answer.item .content .text { margin: 0; padding: 0; }
      .answer.item .content .meta { margin: 0; padding: 0; }
      .answer.item .content .links { margin: 0; padding: 0; }

      .comments.list { opacity: 0.75; overflow: visible; margin: 8px 0 0 150px; padding: 4px 0; }
      .comment.item { overflow: visible; position: relative; margin: 0; padding: 4px; border-bottom: 1px dotted #AAA; }
      .comment.item .updown { position: absolute; left: -1.3rem; top: -0.15rem; opacity: 0; transition: 0.3s ease-in; background-color: #F3F3F3; border: 1px dotted #AAA; margin: 0; padding: 0 0.25rem; }
      .comment.item:hover .updown { opacity: 1; transition: 0.3s ease-out; }
      .comment.item .updown .points { display:none; }
      .comment.item .updown form input { font-size: 0.85rem; line-height: 1rem; margin: 0; padding: 0; }
      .comment.item .content { font-size: 0.95rem; margin: 0; padding: 4px 0; }
      .comment.item .content .text {  }
      .comment.item .content .seperator {  }
      .comment.item .content .meta {  }

      /**
       * The little popup bubble that tells anonymous users to login when
       * they click links that are only for authenticated users.
      **/
      .auth-link-popup { width: 200px; overflow: hidden; margin: 0; padding: 16px; background-color: #FFF; border: 1px solid #888; box-shadow: 0 0 8px rgba(0, 0, 0, 0.56); border-radius: 16px; }
      .auth-link-popup p {  }
      .auth-link-popup p:first-child { font-weight: bold; }
      .auth-link-popup p:last-child a { display: inline-block; margin: 0; padding: 8px 16px; transition: 0.3s ease-out; }
      .auth-link-popup p:last-child a:hover { background-color: #E9E9E9; transition: 0.3s ease-out; }

      .pagination { border-top: 1px solid #AAA; margin-top: 8px; padding-top: 8px; }

      footer { margin: 32px 16px 0 16px; padding: 16px;  border-top: 1px solid #AAA; color: #AAA; }
      footer a { color: inherit; }

      /**
       *
      **/

      .question-detail h2 { border-top: 1px solid #AAA; margin-top: 16px; padding-top: 16px; }
    </style>
  </head>
  <body class="{% block body_classes %}{% endblock %}">
    <header>
      <a class="site-name" href="{% url 'home' %}">pre.gunta.me</a>
      <span class="header-nav">
        <a class="ask{% if active_on_navbar == 'home' %} active{% endif %}"
           href="{% url 'question-create' %}{% if tag %}?tags={{ tag }}{% endif %}">{% trans 'ask a question' %}</a>

        <a class="question-list{% if active_on_navbar == 'hot' %} active{% endif %}" href="{% url 'question-list' %}">{% trans 'hot' %}</a>
        <a class="question-list{% if active_on_navbar == 'new' %} active{% endif %}" href="{% url 'question-list' %}?order=new">{% trans 'new' %}</a>
        <a class="question-list{% if active_on_navbar == 'top' %} active{% endif %}" href="{% url 'question-list' %}?order=top">{% trans 'top' %}</a>
        {% if user.is_authenticated %}
          <a class="user-detail{% if active_on_navbar == 'profile' %} active{% endif %}" href="{% url 'user-detail' user.username %}">{% trans 'your questions' %}</a>:
        {% else %}
        {% endif %}
        <a class="tag-list{% if active_on_navbar == 'tags' %} active{% endif %}" href="{% url 'tag-list' %}">{% trans 'tags' %}</a>
        {% if user.is_authenticated %}
          <a class="logout" href="{% url 'account_logout' %}">{% trans 'logout' %}</a>
        {% else %}
          <a class="login{% if active_on_navbar == 'login' %} active{% endif %}" href="{% url 'account_login' %}">{% trans 'login' %}</a>
          <a class="signup{% if active_on_navbar == 'signup' %} active{% endif %}" href="{% url 'account_signup' %}">{% trans 'signup' %}</a>
        {% endif %}
      </span>
    </header>
    <main>
      {% block content %}{% endblock %}
    </main>
    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li onclick="this.classList.add('hide')" class="message{% if message.tags %} {{ message.tags }}{% endif %}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    {% if user.is_anonymous %}
      <div id="js_auth_link_popup" class="auth-link-popup" style="display:none;">
        <p>{% trans 'Please login to do that.' %}</p>
        <p>
          <a href="{% url 'account_login' %}">{% trans 'login' %}</a>
          <a href="{% url 'account_signup'  %}">{% trans 'signup' %}</a>
        </p>
      </div>
    {% endif %}
    <footer>
      &copy; 2016 &mdash; <a href="https://C14L.com/impressum.html">privacy policy - terms of service - imprint - cookie policy</a>
    </footer>
  </body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
  <script>
    $(function(){ 'use strict';

      /**
       * Don't allow newline chars in "textarea.no-newlines" elements.
      **/

      var _re = new RegExp('[\n\r]', 'g');
      $('textarea.no-newlines').on('keyup', function (event) {
        $(this).val($(this).val().replace(_re, ' '));
      });

      /**
       * Intercept clicks on up/downvote and send then via AJAX.
      **/

      function show_auth_link_popup (target) {
        var _target = $(target)[0];
        var _top = _target.offsetTop + 'px';
        var _left = _target.offsetLeft + 'px';
        var _pos = { position: 'absolute', top: _top, left: _left };
        $('#js_auth_link_popup').css(_pos).fadeIn('slow');
      }
      $('.updown form').on('submit', function (event) {
        event.preventDefault();

        var $this = $(this);
        var $otherForm = $this.siblings('form');
        var $points = $this.siblings('.points');
        var url = $this.prop('action');

        $.post(url, $.param($(this).serializeArray())).then(
          function(data, textStatus, jqXHR){
            var wasActive = $this.hasClass('active');
            var otherWasActive = $otherForm.hasClass('active');
            var points = parseInt($points.text());

            $this.removeClass('active');
            $otherForm.removeClass('active');

            if ($this.hasClass('up')) {
              if (wasActive) {
                points -= 1;
              } else {
                $this.addClass('active');
                if (otherWasActive) { points += 2; } else { points += 1; }
              }
            } else if ($this.hasClass('down')) {
              if (wasActive) {
                points += 1;
              } else {
                $this.addClass('active');
                if (otherWasActive) { points -= 2; } else { points -= 1; }
              }
            }
            $points.text(points);
          },
          function (jqXHR, textStatus) {
            if (jqXHR.status == 401) return show_auth_link_popup(event.target);
          });
      });

    });
  </script>
</html>
